<div class = "container" ng-controller = "QueryController as main">
	<p class = "viewResponse" ng-style = "main.responseStyle">{{main.actionResponse}}</p>
	<h1 ng-style = "main.containerStyle">{{main.title}}</h1>
	
	<div class = "addPopupWindow" ng-show = "main.addWindowShow">
		<h2>Edit Part</h1>
		<p class = "viewResponse" ng-style = "main.popupResponseStyle">{{main.popupActionResponse}}</p>
		<hr/>
		<form name="editForm" class="form-horizontal">
			<div class="form-group">
				<label for="addPartNumber" class="col-sm-3 control-label">Part ID</label>
				<div class="col-sm-8">
					<input type="text" class="form-control input-sm" id="addPartNumber" ng-model="addPartNumber" ng-disabled = "true" required />
				</div>
			</div>
			<div class="form-group">
				<label for="addDescription" class="col-sm-3 control-label">Description</label>
				<div class="col-sm-8">
					<input type="text" class="form-control input-sm" id="addDescription" ng-model="addDescription" ng-disabled = "true" required />
				</div>
			</div>
			<div class="form-group">
				<label for="addQuantity" class="col-sm-3 control-label"># Parts to Add</label>
				<div class="col-sm-2">
					<input type="text" class="form-control input-sm" id="addQuantity" ng-model="addQuantity" required />
				</div>
			</div>
			
			<div class = "row" ng-show = "main.addChildren.length > 0">
				<div class="col-md-12">
					<h4>Children Parts</h4>
				</div>
			</div>
			<div class="row" ng-show = "main.addChildren.length > 0">
				<div class="col-md-12">
					<table class="table table-striped table-bordered">
						<thead>
							<tr>
								<th class = "partRow">Child Part Number</th>
								<th class = "partRow">Child Parts per Unit</th>
								<th class = "partRow">Child Parts to be Used</th>
							</tr>
						</thead>
						<tbody>
							<tr ng-repeat="item in main.addChildren">
								<td class = "partRow">{{item.partNumber}}</td>
								<td class = "partRow">{{item.ppi}}</td>
								<td class = "partRow danger">{{item.ppi * addQuantity}}</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
			<div class = "row">
				<div class="col-sm-2">
					<button class="btn btn-success queryEditPart" ng-click= "main.addParts()">Confirm Edit</button>
				</div>
				<div class="col-sm-2">
					<button class="btn btn-success queryCancelEdit" ng-click= "main.closePopupWindow()">Cancel</button>
				</div>
			</div>
		</form>
	</div>
	
	<div class = "editPopupWindow" ng-show = "main.editWindowShow">
		<h2>Edit Part</h1>
		<form name="editForm" class="form">
			<!--  Main form row.  Contains inputs for part number and a description -->
			<div class="row">
				<!-- Part Number Field -->
				<div class = "col-sm-4">
					<div class="form-group">
						<label>Part Number</label>
						<input type="text" class="form-control" ng-model="oldPartNumber" ng-disabled = "true" required />
					</div>
				</div>
				
				<!-- Part Description Field -->
				<div class = "col-sm-8">
					<div class="form-group">
						<label>Part Description</label>
						<input type="text" class="form-control" ng-model="oldDescription" required />
					</div>
				</div>
			</div>
			
			<div class = "row" ng-show = "main.editChildren.length > 0">
				<div class="col-md-12">
					<h4>Children Parts</h4>
				</div>
			</div>
			<div class = "row" ng-show = "main.editChildren.length > 0">
				<div class="col-md-12">
					<table class="table table-striped">
						<tbody>
							<tr>
								<th class = "partRow">Child Part Number</th>
								<th class = "partRow">Description</th>
								<th class = "partRow">Parts per Unit</th>
							</tr>
						</thead>
						<tbody>
							<tr ng-repeat="child in main.editChildren">
								<td class = "partRow">{{child.partNumber}}</td>
								<td class = "partRow col-md-4">{{child.desc}}</td>
								<td class = "partRow">{{child.ppi}}</td>
							</tr>
					</tbody>
					</table>
				</div>
			</div>
			
			<hr/>
			<div class = "row">
				<div class="col-sm-2">
					<button class="btn btn-success queryEditPart" ng-click= "main.editPart()">Confirm Edit</button>
				</div>
				<div class="col-sm-2">
					<button class="btn btn-success queryCancelEdit" ng-click= "main.closePopupWindow()">Cancel</button>
				</div>
			</div>
		</form>
	</div>
	
	<div class = "col-sm-3 queryBackground" ng-style = "main.containerStyle">
		<h3>Item Search</h3>
		<div class="input-group">
			<span class="input-group-addon">
				<span class="search"></span>
			</span>
			<input type="text" class="form-control" ng-model="main.searchInput">
		</div>
		<br/>
		<div>
			<select class="form-control pull-right" ng-model="main.order" ng-options="order as order.title for order in main.orders"></select>
		</div>
		<br/><br/>
		<div>
			<p>
				Search for a part number using the search box.  Click a part row to show the part makeup.
			</p>
		</div>
	</div>
	
	<div class="col-md-9 queryBackground"  ng-style = "main.containerStyle">
		<table class="table table-striped table-bordered">
			<thead>
				<tr>
					<th class = "partRow">Part Number</th>
					<th class = "partRow">Description</th>
					<th class = "partRow">Cost</th>
					<th class = "partRow">Quantity</th>
					<th class = "partRow">UOM</th>
					<th class = "partRow">Children</th>
					<th class = "partRow">Edit Options</th>
				</tr>
			</thead>
			<tbody>
				<tr ng-repeat="item in main.parts | filter:{partNumber:main.searchInput} | orderBy:main.order.key:main.order.reverse">
					<td class = "partRow">{{item.partNumber}}</td>
					<td class = "partRow col-md-4">{{item.desc}}</td>
					<td class = "partRow">${{item.cost}}</td>
					<td class = "partRow">{{item.quantity}}</td>
					<td class = "partRow">{{item.uom}}</td>
					<td class = "partRow">{{item.children.length}}</td>
					<td class = "partRow">
						<span class="badge editBadge subtractIcon anchor" ng-click = "main.openEditWindow(item)"><p class="message">Subtract quantity</p></span>
						<span class="badge editBadge addIcon anchor" ng-click = "main.openAddWindow(item)"><p class="message">Add quantity</p></span>
						<span class="badge editBadge infoIcon anchor" ng-click = "main.openEditWindow(item)"><p class="message">View/edit part information</p></span>
						<span class="badge editBadge removeIcon anchor" ng-click = "main.removePart(item)"><p class="message">Remove part</p></span>
					</td>
				</tr>
			</tbody>
		</table>
	</div>
</div>
